name: Pipeline de Deploy Automatizado

on:
  push:
    branches:
      - dev
      - main

jobs:
  deploy-ambiente-dev:
    if: github.ref == 'refs/heads/dev'
    runs-on: self-hosted
    environment:
      name: dev
    defaults:
      run:
        shell: powershell

    steps:
      - name: Informa√ß√µes de execu√ß√£o
        run: |
          Write-Output " Executado por: ${{ github.actor }}"
          Write-Output "Sistema operacional: ${{ runner.os }}"

      - name: Deploy para ambiente DEV
        run: |
          Write-Output "Iniciando publica√ß√£o em ambiente de desenvolvimento"
          Write-Output "ENV_TYPE (dev): ${{ vars.ENV_TYPE }}"
          Write-Output "Deploy DEV Conclu√≠do"

  deploy-ambiente-prod:
    if: github.ref == 'refs/heads/main'
    runs-on: self-hosted
    environment:
      name: prod
    defaults:
      run:
        shell: powershell

    steps:
      - name: Informa√ß√µes de execu√ß√£o
        run: |
          Write-Output "üîß Executado por: ${{ github.actor }}"
          Write-Output "üñ•Ô∏è Sistema operacional: ${{ runner.os }}"

      - name: Deploy para ambiente PROD
        run: |
          Write-Output "Iniciando processo de publica√ß√£o em produ√ß√£o"
          Write-Output "Token de acesso: ${{ secrets.PROD_KEY }}"
          Write-Output "Aguardando confirma√ß√£o para finalizar deploy PROD"
